#!/bin/bash

# Get the target domain or IP address from the command line argument
target=$1

# Perform a detailed Nmap scan to identify open ports, service versions, and OS
nmap_results=$(nmap -p- -sV --open --min-rate=1000 -T4 $target)

# Check if port 80 (HTTP) is open
if echo "$nmap_results" | grep -q "80/tcp open"; then
    echo "Port 80 is open (HTTP). Initiating GoBuster scan..."
    # Run GoBuster scan for HTTP
    gobuster_results_http=$(gobuster dir -u http://$target -w /usr/share/wordlists/dirb/common.txt -x php,txt,html -t 50)
    echo "GoBuster Results for HTTP:"
    echo "$gobuster_results_http"
else
    echo "Port 80 is not open (HTTP). No GoBuster scan performed."
fi

# Check if port 443 (HTTPS) is open
if echo "$nmap_results" | grep -q "443/tcp open"; then
    echo "Port 443 is open (HTTPS). Initiating GoBuster scan..."
    # Run GoBuster scan for HTTPS
    gobuster_results_https=$(gobuster dir -u https://$target -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html -t 50)
    echo "GoBuster Results for HTTPS:"
    echo "$gobuster_results_https"
    echo "Initiating SSL/TLS vulnerability scan..."
    # Perform SSL/TLS vulnerability scan
    sslscan_results=$(sslscan $target)
    echo "SSL/TLS Vulnerability Scan Results:"
    echo "$sslscan_results"
else
    echo "Port 443 is not open (HTTPS). No GoBuster scan or SSL/TLS scan performed."
fi

# Perform subdomain enumeration using sublist3r
subdomains=$(sublist3r -d $target)
echo "Discovered Subdomains:"
echo "$subdomains"

# Extract service banners
banners=$(echo "$nmap_results" | grep "open")
echo "Service Banners:"
echo "$banners"
